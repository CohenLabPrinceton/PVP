

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>vent.io.iobase &mdash; ventilator 0.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> ventilator
          

          
          </a>

          
            
            
              <div class="version">
                0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Hardware:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../hardware.html">Hardware Placeholder</a></li>
</ul>
<p class="caption"><span class="caption-text">Software:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../common.html">common</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../controller.html">controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../coordinator.html">coordinator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gui.html">GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../io.html">io</a></li>
</ul>
<p class="caption"><span class="caption-text">Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../requirements.html">Ventilator Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../datasheets.html">Datasheets &amp; Manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../specs.html">Specifications</a></li>
</ul>
<p class="caption"><span class="caption-text">Meta:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog/index.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../buildthedocs.html">Building the Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../example_markdown.html">Markdown Example</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ventilator</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>vent.io.iobase</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for vent.io.iobase</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39; Provides the abstract classes and classes for basic objects like</span>
<span class="sd">pins, to be used for higher-level operations by the &quot;device&quot; objects.</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="k">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pigpio</span>


<div class="viewcode-block" id="IODeviceBase"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.IODeviceBase">[docs]</a><span class="k">class</span> <span class="nc">IODeviceBase</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Abstract base Class for pigpio handles (or whatever other GPIO library</span>
<span class="sd">    we end up using)</span>

<span class="sd">    Note: pigpio commands return -144 if an error is encountered while</span>
<span class="sd">    attempting to communicate with the demon. TODO would be to recognize</span>
<span class="sd">    when that occurs and handle it gracefully, i.e. kill the daemon,</span>
<span class="sd">    restart it, and reopen the python interface(s)</span>
<span class="sd">    &#39;&#39;&#39;</span>

<div class="viewcode-block" id="IODeviceBase.__init__"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.IODeviceBase.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pig</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Initializes the pigpio python bindings oject if necessary,</span>
<span class="sd">        and checks that it is actually running.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pig</span> <span class="o">=</span> <span class="n">pig</span> <span class="k">if</span> <span class="n">pig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pigpio</span><span class="o">.</span><span class="n">pi</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pigpiod_ok</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span></div>

    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Closes the i2c/spi connection, and stops the python bindings</span>
<span class="sd">        for the pigpio daemon.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pigpiod_ok</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; The pigpio python bindings object</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pig</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Pigpiod handle associated with device (only for i2c/spi)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span>

<div class="viewcode-block" id="IODeviceBase.pigpiod_ok"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.IODeviceBase.pigpiod_ok">[docs]</a>    <span class="k">def</span> <span class="nf">pigpiod_ok</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Returns True if pigpiod is running and False if not</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">connected</span></div>

<div class="viewcode-block" id="IODeviceBase.close"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.IODeviceBase.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Closes an I2C/SPI (or potentially Serial) connection</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pigpiod_ok</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span></div></div>


<div class="viewcode-block" id="be16_to_native"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.be16_to_native">[docs]</a><span class="k">def</span> <span class="nf">be16_to_native</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Unpacks a bytearray respecting big-endianness of outside world</span>
<span class="sd">    and returns an int according to signed.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="n">count</span><span class="p">],</span><span class="s1">&#39;big&#39;</span><span class="p">,</span><span class="n">signed</span><span class="o">=</span><span class="n">signed</span><span class="p">)</span></div>


<div class="viewcode-block" id="native16_to_be"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.native16_to_be">[docs]</a><span class="k">def</span> <span class="nf">native16_to_be</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Packs an int into a bytearray while swapping big-endianness</span>
<span class="sd">    of the pi and returns bytearray</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">word</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">count</span><span class="p">,</span><span class="s1">&#39;big&#39;</span><span class="p">,</span><span class="n">signed</span><span class="o">=</span><span class="n">signed</span><span class="p">)</span></div>


<div class="viewcode-block" id="I2CDevice"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice">[docs]</a><span class="k">class</span> <span class="nc">I2CDevice</span><span class="p">(</span><span class="n">IODeviceBase</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; A class wrapper for pigpio I2C handles. Defines several methods</span>
<span class="sd">    used for reading from and writing to device registers. Defines</span>
<span class="sd">    helper classes Register and RegisterField for handling the</span>
<span class="sd">    manipulation of arbitrary registers.</span>

<span class="sd">    Note: The Raspberry Pi uses LE byte-ordering, while the outside</span>
<span class="sd">    world tends to use BE (at least, the sensors in use so far all do).</span>
<span class="sd">    Thus, bytes need to be swapped from native (LE) ordering to BE</span>
<span class="sd">    prior to being written to an i2c device, and bytes recieved need to</span>
<span class="sd">    be swapped from BE into native (LE). All methods except read_device</span>
<span class="sd">    and write_device perform this automatically. The methods read_device</span>
<span class="sd">    and write_device do NOT byteswap and return bytearrays rather than</span>
<span class="sd">    the unsigned 16-bit int used by the other read/write methods.</span>
<span class="sd">    &#39;&#39;&#39;</span>
<div class="viewcode-block" id="I2CDevice.__init__"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i2c_address</span><span class="p">,</span> <span class="n">i2c_bus</span><span class="p">,</span> <span class="n">pig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Initializes pigpio bindings and opens i2c connection.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_i2c_bus</span> <span class="o">=</span> <span class="n">i2c_bus</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">i2c_bus</span><span class="p">,</span> <span class="n">i2c_address</span><span class="p">)</span></div>

<div class="viewcode-block" id="I2CDevice.open"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.open">[docs]</a>    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i2c_bus</span><span class="p">,</span> <span class="n">i2c_address</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Opens i2c connection given i2c bus and address.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">i2c_open</span><span class="p">(</span><span class="n">i2c_bus</span><span class="p">,</span> <span class="n">i2c_address</span><span class="p">)</span></div>

<div class="viewcode-block" id="I2CDevice.close"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Extends superclass method. Checks that pigpiod is connected</span>
<span class="sd">        and if a handle has been set - if so, closes an i2c connection.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">i2c_close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span></div>

<div class="viewcode-block" id="I2CDevice.read_device"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.read_device">[docs]</a>    <span class="k">def</span> <span class="nf">read_device</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_bytes</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Read a specified number of bytes directly from the the</span>
<span class="sd">        device without changing the register. Does NOT perform LE/BE</span>
<span class="sd">        conversion.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">i2c_read_device</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">num_bytes</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="I2CDevice.write_device"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.write_device">[docs]</a>    <span class="k">def</span> <span class="nf">write_device</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Write bytes to the device without specifying register.</span>
<span class="sd">        DOES perform LE/BE conversion. Count should be</span>
<span class="sd">        specified for when passing something other than a word.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">i2c_write_device</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span>
            <span class="n">native16_to_be</span><span class="p">(</span><span class="n">word</span><span class="p">,</span><span class="n">signed</span><span class="o">=</span><span class="n">signed</span><span class="p">,</span><span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="I2CDevice.read_register"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.read_register">[docs]</a>    <span class="k">def</span> <span class="nf">read_register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">register</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Read count# bytes from the specified register</span>
<span class="sd">        (denoted by a single byte)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">be16_to_native</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">i2c_read_i2c_block_data</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span>
                <span class="n">register</span><span class="p">,</span>
                <span class="n">count</span>
            <span class="p">),</span>
            <span class="n">signed</span><span class="o">=</span><span class="n">signed</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="I2CDevice.write_register"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.write_register">[docs]</a>    <span class="k">def</span> <span class="nf">write_register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">register</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span><span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">count</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Write bytes to the specified register. Count should be</span>
<span class="sd">        specified for when passing something other than a word.</span>
<span class="sd">        (register denoted by a single byte)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">i2c_write_i2c_block_data</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span>
            <span class="n">register</span><span class="p">,</span>
            <span class="n">native16_to_be</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="n">signed</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="I2CDevice.Register"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.Register">[docs]</a>    <span class="k">class</span> <span class="nc">Register</span><span class="p">:</span>
        <span class="sd">&#39;&#39;&#39; Describes a writable configuration register. Has dynamically</span>
<span class="sd">        defined attributes corresponding to the fields described by the</span>
<span class="sd">        passed arguments. Takes as arguments two tuples of equal length,</span>
<span class="sd">        the first of which names each field and the second being a tuple</span>
<span class="sd">        of tuples containing the (human readable) possible settings &amp;</span>
<span class="sd">        values for each field.</span>

<span class="sd">        Note: The intializer reverses the fields &amp; their values because</span>
<span class="sd">        a human reads the register, as drawn in the datasheet, from left</span>
<span class="sd">        to right - however, the fields furthest to the left are the most</span>
<span class="sd">        significant bits of the register.</span>
<span class="sd">        &#39;&#39;&#39;</span>
<div class="viewcode-block" id="I2CDevice.Register.__init__"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.Register.__init__">[docs]</a>        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39; Initializer which loads in (dynamically defined)</span>
<span class="sd">            attributes.</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">fld</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">fields</span><span class="p">),</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
                <span class="nb">setattr</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span>
                    <span class="n">fld</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">RegisterField</span><span class="p">(</span>
                        <span class="n">offset</span><span class="p">,</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))))</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">offset</span> <span class="o">+=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span></div>

<div class="viewcode-block" id="I2CDevice.Register.unpack"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.Register.unpack">[docs]</a>        <span class="k">def</span> <span class="nf">unpack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39; Given the contents of a register in integer form,</span>
<span class="sd">            returns a dict of fields and their current settings</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span>
                    <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span>
                        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">field</span><span class="p">),</span>
                        <span class="s1">&#39;unpack&#39;</span> <span class="p">)(</span><span class="n">cfg</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
                <span class="p">))</span></div>

<div class="viewcode-block" id="I2CDevice.Register.pack"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.Register.pack">[docs]</a>        <span class="k">def</span> <span class="nf">pack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39; Given an initial integer representation of a register and an</span>
<span class="sd">            arbitrary number of field=value settings, returns an integer</span>
<span class="sd">            representation of the register incorporating the new settings.</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cfg</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">),</span> <span class="s1">&#39;insert&#39;</span> <span class="p">)(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cfg</span></div>


<div class="viewcode-block" id="I2CDevice.Register.RegisterField"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.Register.RegisterField">[docs]</a>        <span class="k">class</span> <span class="nc">RegisterField</span><span class="p">:</span>
            <span class="sd">&#39;&#39;&#39; Describes a configurable field in a writable register.</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span>    <span class="o">=</span> <span class="n">offset</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_mask</span>      <span class="o">=</span> <span class="n">mask</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>    <span class="o">=</span> <span class="n">values</span>

<div class="viewcode-block" id="I2CDevice.Register.RegisterField.offset"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.Register.RegisterField.offset">[docs]</a>            <span class="k">def</span> <span class="nf">offset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="sd">&#39;&#39;&#39; Returns the position of the field&#39;s LSB in the</span>
<span class="sd">                register. Example: mask = self._mask &lt;&lt; self._offset</span>
<span class="sd">                &#39;&#39;&#39;</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span></div>

<div class="viewcode-block" id="I2CDevice.Register.RegisterField.info"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.Register.RegisterField.info">[docs]</a>            <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="sd">&#39;&#39;&#39; Returns a list containing stuff &#39;&#39;&#39;</span>
                <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mask</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">]</span></div>

<div class="viewcode-block" id="I2CDevice.Register.RegisterField.unpack"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.Register.RegisterField.unpack">[docs]</a>            <span class="k">def</span> <span class="nf">unpack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg</span><span class="p">):</span>
                <span class="sd">&#39;&#39;&#39; Extracts setting from passed 16-bit config &amp; returns</span>
<span class="sd">                human readable result.</span>
<span class="sd">                &#39;&#39;&#39;</span>
                <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">reversed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">items</span><span class="p">()))[</span><span class="bp">self</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">cfg</span><span class="p">)]</span></div>

<div class="viewcode-block" id="I2CDevice.Register.RegisterField.pack"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.Register.RegisterField.pack">[docs]</a>            <span class="k">def</span> <span class="nf">pack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="sd">&#39;&#39;&#39; Takes a human-readable setting and returns a</span>
<span class="sd">                bit-shifted integer.</span>
<span class="sd">                &#39;&#39;&#39;</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span></div>

<div class="viewcode-block" id="I2CDevice.Register.RegisterField.insert"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.Register.RegisterField.insert">[docs]</a>            <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="sd">&#39;&#39;&#39; Performs validation and then does a bitwise</span>
<span class="sd">                replacement on passed config with the passed value.</span>
<span class="sd">                Returns integer representation of the new config.</span>
<span class="sd">                &#39;&#39;&#39;</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;RegisterField must be one of: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
                <span class="k">return</span> <span class="p">(</span> <span class="n">cfg</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mask</span><span class="o">&lt;&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">)</span> <span class="p">)</span><span class="o">|</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span> <span class="p">)</span></div>

<div class="viewcode-block" id="I2CDevice.Register.RegisterField.extract"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.I2CDevice.Register.RegisterField.extract">[docs]</a>            <span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg</span><span class="p">):</span>
                <span class="sd">&#39;&#39;&#39; Extracts setting from passed 16-bit config &amp; returns</span>
<span class="sd">                integer representation.</span>
<span class="sd">                &#39;&#39;&#39;</span>
                <span class="k">return</span> <span class="p">(</span> <span class="n">cfg</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mask</span><span class="o">&lt;&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">)</span> <span class="p">)</span><span class="o">&gt;&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span></div></div></div></div>


<div class="viewcode-block" id="SPIDevice"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.SPIDevice">[docs]</a><span class="k">class</span> <span class="nc">SPIDevice</span><span class="p">(</span><span class="n">IODeviceBase</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A class wrapper for pigpio SPI handles. Not really implemented.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">baudrate</span><span class="p">,</span> <span class="n">pig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">baudrate</span><span class="p">)</span>

<div class="viewcode-block" id="SPIDevice.open"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.SPIDevice.open">[docs]</a>    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">baudrate</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Opens an SPI connection and returns the pigpiod handle.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">spi_open</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">baudrate</span><span class="p">)</span></div>

<div class="viewcode-block" id="SPIDevice.close"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.SPIDevice.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Extends superclass method. Checks that pigpiod is connected</span>
<span class="sd">        and if a handle has been set - if so, closes an SPI connection.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">spi_close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Sensor"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Sensor">[docs]</a><span class="k">class</span> <span class="nc">Sensor</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Abstract base Class describing generalized sensors. Defines a</span>
<span class="sd">    mechanism for limited internal storage of recent observations and</span>
<span class="sd">    methods to pull that data out for external use.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">_DEFAULT_STORED_OBSERVATIONS</span> <span class="o">=</span> <span class="mi">128</span>

<div class="viewcode-block" id="Sensor.__init__"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Sensor.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Upon creation, calls update() to ensure that if get is</span>
<span class="sd">        called there will be something to return</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_STORED_OBSERVATIONS</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_i</span>     <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_STORED_OBSERVATIONS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_timestamp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span></div>

<div class="viewcode-block" id="Sensor.update"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Sensor.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Make a sensor reading, verify that it makes sense and store</span>
<span class="sd">        the result internally. Returns True if reading was verified and</span>
<span class="sd">        False if something went wrong.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verify</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__store_last</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verify</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sensor.get"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Sensor.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Return the most recent sensor reading.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_timestamp</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeWarning</span><span class="p">(</span><span class="s1">&#39;get() called before update()&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_length</span><span class="p">]</span></div>

<div class="viewcode-block" id="Sensor.age"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Sensor.age">[docs]</a>    <span class="k">def</span> <span class="nf">age</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Returns the time since the last sensor update, in seconds.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_timestamp</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;age() called before update()&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_timestamp</span></div>

<div class="viewcode-block" id="Sensor.reset"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Sensor.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Resets the sensors internal memory. May be overloaded by</span>
<span class="sd">        subclasses to extend functionality specific to a device.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_i</span>     <span class="o">=</span> <span class="mi">0</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Generalized, not necessarily performant. Returns an ndarray</span>
<span class="sd">        of observations arranged oldest to newest. Result has length</span>
<span class="sd">        equal to the lessor of self.n and the number of observations</span>
<span class="sd">        made.</span>

<span class="sd">        Note: ndarray.astype(bool) returns an equivalent sized array</span>
<span class="sd">        with True for each nonzero element and False everywhere else.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">rolled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_length</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rolled</span><span class="p">[</span><span class="n">rolled</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Returns the number of observations kept in the Sensor&#39;s</span>
<span class="sd">        internal ndarray. Once the ndarray has been filled, the sensor</span>
<span class="sd">        begins overwriting the oldest elements of the ndarray with new</span>
<span class="sd">        observations such that the size of the internal storage stays</span>
<span class="sd">        constant.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_length</span>

    <span class="nd">@data_length</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">data_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data_length</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Set a new length for stored observations. Clears existing</span>
<span class="sd">        observations and resets. &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_length</span> <span class="o">=</span> <span class="n">new_data_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<div class="viewcode-block" id="Sensor._read"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Sensor._read">[docs]</a>    <span class="k">def</span> <span class="nf">_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Calls _raw_read and scales the result before returning it</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_raw_read</span><span class="p">())</span></div>

<div class="viewcode-block" id="Sensor._verify"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Sensor._verify">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Validate reading and throw exception/alarm if sensor does not</span>
<span class="sd">        appear to be working correctly</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Subclass must implement _verify()&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sensor._convert"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Sensor._convert">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Converts a raw reading from a sensor in whatever forma</span>
<span class="sd">        the device communicates with into a meaningful result.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Subclass must implement _raw_read()&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sensor._raw_read"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Sensor._raw_read">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_raw_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Requests a new observation from the device and returns the</span>
<span class="sd">        raw result in whatever format/units the device communicates with</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Subclass must implement _raw_read()&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__store_last</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Takes a value and stores it in self.data. Increments counter</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_i</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">data_length</span></div>


<div class="viewcode-block" id="AnalogSensor"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.AnalogSensor">[docs]</a><span class="k">class</span> <span class="nc">AnalogSensor</span><span class="p">(</span><span class="n">Sensor</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Generalized class describing an analog sensor attached to the</span>
<span class="sd">    ADS1115 analog to digital converter. Inherits from the sensor base</span>
<span class="sd">    class and extends with functionality specific to analog sensors</span>
<span class="sd">    attached to the ads1115.</span>

<span class="sd">    If instantiated without a subclass, conceptually represents a</span>
<span class="sd">    voltmeter with a normalized output.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">_DEFAULT_OFFSET_VOLTAGE</span>     <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_DEFAULT_OUTPUT_SPAN</span>        <span class="o">=</span> <span class="mi">5</span>
    <span class="n">_CONVERSION_FACTOR</span>          <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_DEFAULT_CALIBRATION</span>        <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;OFFSET_VOLTAGE&#39;</span> <span class="p">:</span> <span class="n">_DEFAULT_OFFSET_VOLTAGE</span><span class="p">,</span>
            <span class="s1">&#39;OUTPUT_SPAN&#39;</span>    <span class="p">:</span> <span class="n">_DEFAULT_OUTPUT_SPAN</span>
    <span class="p">}</span>

<div class="viewcode-block" id="AnalogSensor.__init__"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.AnalogSensor.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">adc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Links analog sensor on the ADC with configutation options</span>
<span class="sd">        specified. If no options are specified, it assumes the settings</span>
<span class="sd">        currently on the ADC.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adc</span> <span class="o">=</span> <span class="n">adc</span>
        <span class="k">if</span> <span class="s1">&#39;MUX&#39;</span> <span class="ow">not</span> <span class="ow">in</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s1">&#39;User must specify MUX for AnalogSensor creation&#39;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_and_set_attr</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="AnalogSensor.calibrate"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.AnalogSensor.calibrate">[docs]</a>    <span class="k">def</span> <span class="nf">calibrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Sets the calibration of the sensor, either to the values</span>
<span class="sd">        contained in the passed tuple or by some routine; the current</span>
<span class="sd">        routine is pretty rudimentary and only calibrates offset voltage</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">fld</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">fld</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_CALIBRATION</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fld</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="c1"># PRINT FOR DEBUG / HARDWARE TESTING</span>
                <span class="nb">print</span><span class="p">(</span>
                        <span class="s1">&#39;Analog Sensor Calibration @ </span><span class="si">%6.4f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                <span class="p">)</span>
                        <span class="p">,</span>
                        <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span>
                <span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;OFFSET_VOLTAGE&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:]))</span>
            <span class="c1"># PRINT FOR DEBUG / HARDWARE TESTING</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Calibrated low-end of AnalogSensor @&#39;</span><span class="p">,</span>
            <span class="s1">&#39; </span><span class="si">%6.4f</span><span class="s1"> V&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;OFFSET_VOLTAGE&#39;</span><span class="p">)))</span></div>

<div class="viewcode-block" id="AnalogSensor._read"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.AnalogSensor._read">[docs]</a>    <span class="k">def</span> <span class="nf">_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Returns a value in the range of 0 - 1 corresponding to a</span>
<span class="sd">        fraction of the full input range of the sensor</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_raw_read</span><span class="p">())</span></div>

<div class="viewcode-block" id="AnalogSensor._verify"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.AnalogSensor._verify">[docs]</a>    <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Checks to make sure sensor reading was indeed in [0, 1]</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">report</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="mi">0</span><span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">report</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">report</span></div>

<div class="viewcode-block" id="AnalogSensor._convert"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.AnalogSensor._convert">[docs]</a>    <span class="k">def</span> <span class="nf">_convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Scales raw voltage into the range 0 - 1</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">raw</span> <span class="o">-</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;OFFSET_VOLTAGE&#39;</span><span class="p">))</span>
                <span class="o">/</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;OUTPUT_SPAN&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;OFFSET_VOLTAGE&#39;</span><span class="p">))</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="AnalogSensor._raw_read"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.AnalogSensor._raw_read">[docs]</a>    <span class="k">def</span> <span class="nf">_raw_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Builds kwargs from configured fields to pass along to adc,</span>
<span class="sd">        then calls adc.read_conversion(), which returns a raw voltage.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adc</span><span class="o">.</span><span class="n">USER_CONFIGURABLE_FIELDS</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
            <span class="n">fields</span><span class="p">,</span>
            <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">)</span>
        <span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">adc</span><span class="o">.</span><span class="n">read_conversion</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="AnalogSensor._fill_attr"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.AnalogSensor._fill_attr">[docs]</a>    <span class="k">def</span> <span class="nf">_fill_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Examines self to see if there are any fields identified as</span>
<span class="sd">        user configurable or calibration that have not been set (i.e.</span>
<span class="sd">        were not passed to __init__ as **kwargs). If a field is missing,</span>
<span class="sd">        grabs the default value either from the ADC or from</span>
<span class="sd">        _DEFAULT_CALIBRATION and sets it as an attribute.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">cfld</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adc</span><span class="o">.</span><span class="n">USER_CONFIGURABLE_FIELDS</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfld</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span>
                        <span class="n">cfld</span><span class="p">,</span>
                        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adc</span><span class="o">.</span><span class="n">config</span><span class="p">,</span><span class="n">cfld</span><span class="p">)</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adc</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">for</span> <span class="n">dcal</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_CALIBRATION</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dcal</span><span class="p">):</span> <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dcal</span><span class="p">,</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="AnalogSensor._check_and_set_attr"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.AnalogSensor._check_and_set_attr">[docs]</a>    <span class="k">def</span> <span class="nf">_check_and_set_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Checks to see if arguments passed to __init__ are recognized</span>
<span class="sd">        as user configurable or calibration fields. If so, set the value</span>
<span class="sd">        as an attribute like: self.KEY = VALUE. Keeps track of how many</span>
<span class="sd">        attributes are set in this way; if at the end there unknown</span>
<span class="sd">        arguments leftover, raises a TypeError; otherwise, calls</span>
<span class="sd">        _fill_attr() to fill in fields that were not passed</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">allowed</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">adc</span><span class="o">.</span><span class="n">USER_CONFIGURABLE_FIELDS</span><span class="p">,</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_CALIBRATION</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">fld</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">fld</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fld</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;AnalogSensor was passed unknown field(s)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill_attr</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="Pin"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Pin">[docs]</a><span class="k">class</span> <span class="nc">Pin</span><span class="p">(</span><span class="n">IODeviceBase</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Base Class wrapping pigpio methods for interacting with GPIO pins on</span>
<span class="sd">    the raspberry pi. Subclasses include InputPin, OutputPin; along with</span>
<span class="sd">    any specialized pins or specific devices defined in vent.io.actuators</span>
<span class="sd">    &amp; vent.io.sensors (note: actuators and sensors do not need to be tied</span>
<span class="sd">    to a GPIO pin and may instead be interfaced through an ADC or I2C).</span>

<span class="sd">    When this class is initialized without a subclass, it represents a</span>
<span class="sd">    fully-functional binary digital GPIO pin. The subclasses InputPin and</span>
<span class="sd">    OutputPin overload some functionaly of Pin in order to ensure the user</span>
<span class="sd">    is warned when they call methods that are not consistent with the</span>
<span class="sd">    declared use (i.e. calling .set() on an InputPin).</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">_PIGPIO_MODES</span> <span class="o">=</span> <span class="p">{</span>   <span class="s1">&#39;INPUT&#39;</span>     <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s1">&#39;OUTPUT&#39;</span>    <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s1">&#39;ALT5&#39;</span>      <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                        <span class="s1">&#39;ALT4&#39;</span>      <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                        <span class="s1">&#39;ALT0&#39;</span>      <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                        <span class="s1">&#39;ALT1&#39;</span>      <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                        <span class="s1">&#39;ALT2&#39;</span>      <span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                        <span class="s1">&#39;ALT3&#39;</span>      <span class="p">:</span> <span class="mi">7</span> <span class="p">}</span>

<div class="viewcode-block" id="Pin.__init__"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Pin.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pin</span><span class="p">,</span> <span class="n">pig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Inherits attributes and methods from IODeviceBase.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="o">=</span><span class="n">pin</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; The currently active pigpio mode of the pin.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">reversed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PIGPIO_MODES</span><span class="o">.</span><span class="n">items</span><span class="p">()))[</span><span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">get_mode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">)]</span>

    <span class="nd">@mode</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Performs validation on requested mode, then sets the mode.</span>
<span class="sd">        Raises runtime error if something goes wrong.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PIGPIO_MODES</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pin mode must be one of: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_PIGPIO_MODES</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PIGPIO_MODES</span><span class="p">[</span><span class="n">mode</span><span class="p">])</span>

        <span class="c1"># Pull error and print it</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Failed to set mode </span><span class="si">{}</span><span class="s1"> on pin </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">))</span>

<div class="viewcode-block" id="Pin.get"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Pin.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Returns the value of the pin: usually 0 or 1 but can be</span>
<span class="sd">        overridden e.g. by PWM which returns duty cycle.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pin.set"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.Pin.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Sets the value of the Pin. Usually 0 or 1 but behavior</span>
<span class="sd">        differs for some subclasses.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot set a value other than 0 or 1 to a Pin&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="InputPin"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.InputPin">[docs]</a><span class="k">class</span> <span class="nc">InputPin</span><span class="p">(</span><span class="n">Pin</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Subclass of Pin that should be used when calls to the pin should be</span>
<span class="sd">    read-only during normal operation.</span>
<span class="sd">    That is, if a call is made to set the value on an InputPin, it will</span>
<span class="sd">    throw a runtime warning.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pin</span><span class="p">,</span> <span class="n">pig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span> <span class="n">pig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;INPUT&#39;</span>

<div class="viewcode-block" id="InputPin.set"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.InputPin.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Extends superclass method to raise a warning that pin is</span>
<span class="sd">        being used in a manner contrary to its declared nature.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">RuntimeWarning</span><span class="p">(</span><span class="s1">&#39;set() was called on an InputPin&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="OutputPin"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.OutputPin">[docs]</a><span class="k">class</span> <span class="nc">OutputPin</span><span class="p">(</span><span class="n">Pin</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Subclass of Pin that should be used when calls to the pin should be</span>
<span class="sd">    write-only during normal operation.</span>
<span class="sd">    That is, if a call is made to get the value of an OutputPin, it will</span>
<span class="sd">    throw a runtime warning.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pin</span><span class="p">,</span> <span class="n">pig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span> <span class="n">pig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;OUTPUT&#39;</span>

<div class="viewcode-block" id="OutputPin.on"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.OutputPin.on">[docs]</a>    <span class="k">def</span> <span class="nf">on</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Turn on a pin.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="OutputPin.off"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.OutputPin.off">[docs]</a>    <span class="k">def</span> <span class="nf">off</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Turn off a pin.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="OutputPin.toggle"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.OutputPin.toggle">[docs]</a>    <span class="k">def</span> <span class="nf">toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; If pin is on, turn it off. If it&#39;s off, turn it on. Do not</span>
<span class="sd">        raise a warning when pin is read in this way.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span></div>

<div class="viewcode-block" id="OutputPin.get"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.OutputPin.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Extends superclass method to raise a warning that pin is</span>
<span class="sd">        being used in a manner contrary to its declared nature.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">raise</span> <span class="ne">RuntimeWarning</span><span class="p">(</span><span class="s1">&#39;get() was called on an OutputPin&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PWMOutput"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.PWMOutput">[docs]</a><span class="k">class</span> <span class="nc">PWMOutput</span><span class="p">(</span><span class="n">OutputPin</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    I am a Special Pin!</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">_DEFAULT_FREQUENCY</span>      <span class="o">=</span> <span class="mi">20000</span>
    <span class="n">_DEFAULT_SOFT_FREQ</span>      <span class="o">=</span> <span class="mi">2000</span>
    <span class="n">_HARDWARE_PWM_PINS</span>      <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pin</span><span class="p">,</span> <span class="n">initial_duty</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span> <span class="n">pig</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pin</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_HARDWARE_PWM_PINS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hardware_enabled</span>   <span class="o">=</span> <span class="kc">False</span>
            <span class="n">default_frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_SOFT_FREQ</span>
            <span class="k">raise</span> <span class="ne">RuntimeWarning</span><span class="p">(</span><span class="s1">&#39;PWMOutput called on pin </span><span class="si">{}</span><span class="s1"> but that is not a PWM channel. Available frequencies will be limited.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hardware_enabled</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">default_frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_FREQUENCY</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__pwm</span><span class="p">(</span><span class="n">frequency</span> <span class="k">if</span> <span class="n">frequency</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">default_frequency</span><span class="p">,</span> <span class="n">initial_duty</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Return the current PWM frequency active on the pin.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">get_PWM_frequency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">)</span>

    <span class="nd">@frequency</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_frequency</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Description:</span>
<span class="sd">        Note: pigpio.pi.hardware_PWM() returns 0 if OK and an error code otherwise.</span>
<span class="sd">        - Tries to set hardware PWM if hardware_enabled</span>
<span class="sd">        - If that fails, or if not hardware_enabled, tries to set software PWM instead.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__pwm</span><span class="p">(</span><span class="n">new_frequency</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">duty</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">duty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Description:</span>
<span class="sd">        Returns the PWM duty cycle (pulled straight from pigpiod) mapped to the range [0-1] &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">get_PWM_dutycycle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">get_PWM_range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">)</span>

    <span class="nd">@duty</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">duty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duty_cycle</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Description:</span>
<span class="sd">        Validation of requested duty cycle is performed here.</span>
<span class="sd">        Sets the PWM duty cycle to a value proportional to the input between (0, 1) &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">duty_cycle</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Duty cycle must be between 0 and 1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__pwm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">duty_cycle</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">get_PWM_range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">)))</span>

<div class="viewcode-block" id="PWMOutput.get"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.PWMOutput.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Overloaded to return duty cycle instead of reading the value on the pin &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">duty</span></div>

<div class="viewcode-block" id="PWMOutput.set"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.PWMOutput.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Overloaded to set duty cycle&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">duty</span> <span class="o">=</span> <span class="n">value</span></div>

<div class="viewcode-block" id="PWMOutput.on"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.PWMOutput.on">[docs]</a>    <span class="k">def</span> <span class="nf">on</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Same functionality as parent, but done with PWM intact&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">duty</span> <span class="o">=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PWMOutput.off"><a class="viewcode-back" href="../../../io.html#vent.io.iobase.PWMOutput.off">[docs]</a>    <span class="k">def</span> <span class="nf">off</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Same functionality as parent, but done with PWM intact&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">duty</span> <span class="o">=</span> <span class="mi">0</span></div>

    <span class="k">def</span> <span class="nf">__pwm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">duty</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Description:</span>
<span class="sd">        -If hardware_enabled is True, start a hardware pwm with the requested duty.</span>
<span class="sd">        -Otherwise (or if setting a hardware pwm fails and hardware_enabled is set to False),</span>
<span class="sd">         set a software pwm in the same manner.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hardware_enabled</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__hardware_pwm</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">duty</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hardware_enabled</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__software_pwm</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">duty</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__hardware_pwm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">duty</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Description:</span>
<span class="sd">        -Tries to set a hardware pwm. result == 0 if it suceeds.</span>
<span class="sd">        -Sets hardware_enabled flag to indicate success or failure&#39;&#39;&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">hardware_PWM</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">duty</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hardware_enabled</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">raise</span> <span class="ne">RuntimeWarning</span><span class="p">(</span><span class="s1">&#39;Failed to start hardware PWM with frequency </span><span class="si">{}</span><span class="s1"> on pin </span><span class="si">{}</span><span class="s1">. Error: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">error_text</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hardware_enabled</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__software_pwm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">duty</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Used for pins where hardware PWM is not available. &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">set_PWM_dutycycle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">,</span> <span class="n">duty</span><span class="p">)</span>
        <span class="n">realized_frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pig</span><span class="o">.</span><span class="n">set_PWM_frequency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">,</span> <span class="n">frequency</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">frequency</span> <span class="o">!=</span> <span class="n">realized_frequency</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeWarning</span><span class="p">(</span><span class="s1">&#39;A PWM frequency of </span><span class="si">{}</span><span class="s1"> was requested but the best that could be done was </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">realized_frequency</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardware_enabled</span> <span class="o">=</span> <span class="kc">False</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, jonny saunders et al

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>